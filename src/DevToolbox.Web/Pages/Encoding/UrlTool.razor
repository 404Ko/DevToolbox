@page "/encoding/url"
@inject DevToolbox.Web.Services.IEncodingService EncodingService

<PageTitle>URL ç¼–ç /è§£ç  - DevToolbox</PageTitle>

@* URLç¼–ç å·¥å…· (AI Accept) *@
<div class="tool-page">
    <div class="tool-header">
        <h1>ğŸ”— URL ç¼–ç /è§£ç </h1>
        <p>å¯¹URLä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œç¼–ç æˆ–è§£ç </p>
    </div>

    <div class="tool-content">
        <div class="card">
            <div class="card-header">
                <span>è¾“å…¥</span>
                <button class="btn btn-sm btn-secondary" @onclick="Clear">æ¸…ç©º</button>
            </div>
            <div class="card-body">
                <textarea class="form-control" @bind="InputText"
                          placeholder="è¯·è¾“å…¥URLæˆ–æ–‡æœ¬..."></textarea>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <span>è¾“å‡º</span>
                <button class="btn btn-sm btn-primary" @onclick="CopyOutput">å¤åˆ¶</button>
            </div>
            <div class="card-body">
                <textarea class="form-control" @bind="OutputText" readonly
                          placeholder="ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ..."></textarea>
            </div>
        </div>
    </div>

    <div class="btn-group" style="margin-top: 20px; justify-content: center;">
        <button class="btn btn-primary" @onclick="Encode">ç¼–ç  â†’</button>
        <button class="btn btn-success" @onclick="Decode">â† è§£ç </button>
        <button class="btn btn-secondary" @onclick="Swap">â‡„ äº¤æ¢</button>
    </div>

    @if (!string.IsNullOrEmpty(ErrorMessage))
    {
        <div class="alert alert-danger">@ErrorMessage</div>
    }
</div>

@code {
    // AI Accept [Added]: URL encoding tool
    private string InputText { get; set; } = string.Empty;
    private string OutputText { get; set; } = string.Empty;
    private string ErrorMessage { get; set; } = string.Empty;

    private void Encode()
    {
        try
        {
            ErrorMessage = string.Empty;
            OutputText = EncodingService.UrlEncode(InputText);
        }
        catch (Exception ex)
        {
            ErrorMessage = $"ç¼–ç å¤±è´¥: {ex.Message}";
        }
    }

    private void Decode()
    {
        try
        {
            ErrorMessage = string.Empty;
            OutputText = EncodingService.UrlDecode(InputText);
        }
        catch (Exception ex)
        {
            ErrorMessage = $"è§£ç å¤±è´¥: {ex.Message}";
        }
    }

    private void Swap() => (InputText, OutputText) = (OutputText, InputText);
    private void Clear() { InputText = OutputText = ErrorMessage = string.Empty; }
    private void CopyOutput() { }
}
